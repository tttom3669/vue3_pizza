import{l as L,c as v}from"./cartStore-bb83da21.js";import{_ as N,m as w,a as g,r as m,o as d,c,b as s,F as y,e as P,h as A,i as x,q as V,g as F,t as n,d as l,w as k,f as T,n as h}from"./index-138d938a.js";import{s as $}from"./swalMessage-59933fbf.js";import"./sweetalert2.all-07293f25.js";const{VITE_APP_URL:U,VITE_APP_PATH:C}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/V2",VITE_APP_PATH:"tttom3669",BASE_URL:"/vue3_pizza/",MODE:"production",DEV:!1,PROD:!0},u=L(),D={data(){return{userForm:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:""}},computed:{...w(v,["cart"]),...w(L,["isLoading"])},methods:{...g($,["swalShow"]),...g(v,["getCart"]),createOrder(){const o=`${U}/api/${C}/order`,e=this.userForm;u.isLoading=!0,this.$http.post(o,{data:e}).then(i=>{const{message:b,orderId:a}=i.data;u.isLoading=!1,this.swalShow(`${b}`,"success","toast"),this.$router.push(`/checkout/${a}`)}).catch(i=>{u.isLoading=!1,this.swalShow(`${i.response.data.message}`,"error")})},addCouponCode(){const o=`${U}/api/${C}/coupon`,e={code:this.coupon_code};u.isLoading=!0,this.$http.post(o,{data:e}).then(i=>{u.isLoading=!1,this.getCart(),this.swalShow(`${i.data.message}`,"success","toast")}).catch(i=>{u.isLoading=!1,this.swalShow(`${i.response.data.message}`,"error")})}},mounted(){this.getCart()}},B={class:"bg_texture2"},q={class:"container mb-4"},M=s("div",{class:"row d-flex justify-content-center mt-3"},[s("div",{class:"col-12 col-md-6"},[s("div",{class:"col"},[s("div",{class:"position-relative m-4"},[s("div",{class:"progress",style:{height:"1px"}},[s("div",{class:"progress-bar",role:"progressbar",style:{width:"50%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),s("div",{class:"position-absolute top-0 start-0 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 1 "),s("div",{class:"position-absolute top-0 start-50 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 2 "),s("div",{class:"position-absolute top-0 start-100 text-white translate-middle btn btn-sm btn-secondary rounded-pill",style:{width:"2rem",height:"2rem"}}," 3 ")])]),s("div",{class:"col d-flex justify-content-between text-primary fw-bold"},[s("span",{class:"ms-n1"},"確認購買"),s("span",null,"填寫資料"),s("span",{class:"text-secondary me-n1"},"完成訂單")])])],-1),j={class:"row mt-4"},O={class:"col-md-5"},R={class:"card"},z={class:"card-body"},H=s("h5",{class:"card-title"},"訂單明細",-1),G={key:0,class:"table align-middle"},J=["src"],K={class:"p-2"},Q={class:"d-flex flex-column"},W={class:"text-nowrap mb-1"},X={class:"text-nowrap mb-1"},Y={class:"text-nowrap p-2"},Z={class:"text-nowrap p-2"},ss={key:0},es=s("small",{class:"text-success"},"折扣價：",-1),ts=s("span",null,null,-1),os={key:1},as={class:"row row-cols-2 d-flex justify-content-between"},ls={class:"input-group mb-3"},rs=s("div",{class:"py-2 col text-cusGray fw-bold text-start"},"小計",-1),ns={class:"py-2 col text-cusGray fw-bold text-end"},is=s("div",{class:"py-2 col text-success fw-bold text-start border-bottom"}," 優惠折抵 ",-1),ds={class:"py-2 col text-success fw-bold text-end border-bottom"},cs=s("div",{class:"col py-2 h5 text-cusDarkBrown fw-bold text-start"}," 總計 ",-1),us={class:"col py-2 h5 text-cusDarkBrown fw-bold text-end"},ms={class:"col-md-7"},ps=s("h4",{class:"h4 text-center mt-3 mt-md-0"},"訂單資訊",-1),_s={class:"mb-3"},hs=s("label",{for:"email",class:"form-label"},"Email",-1),bs={class:"mb-3"},fs=s("label",{for:"InputUserName",class:"form-label"},"收件人姓名",-1),vs={class:"mb-3"},ws=s("label",{for:"InputUserTel",class:"form-label"},"收件人電話",-1),gs={class:"mb-3"},ys=s("label",{for:"InputUserAddress",class:"form-label"},"收件人地址",-1),xs={class:"mb-3"},Vs=s("label",{for:"FormControlTextarea",class:"form-label"},"備註",-1),Fs=s("div",{class:"d-flex justify-content-end"},[s("button",{type:"submit",class:"btn btn-primary text-white"}," 下一步 ")],-1);function ks(o,e,i,b,a,f){const I=m("router-link"),p=m("VField"),_=m("ErrorMessage"),S=m("VForm"),E=m("VueLoading");return d(),c(y,null,[s("div",B,[s("div",q,[M,s("div",j,[s("div",O,[s("div",R,[s("div",z,[H,o.cart.carts?(d(),c("table",G,[s("tbody",null,[(d(!0),c(y,null,P(o.cart.carts,t=>(d(),c("tr",{key:t.id},[s("td",null,[s("img",{src:t.product.imageUrl,alt:"",class:"object-fit-cover",height:"70",width:"70"},null,8,J)]),s("td",K,[s("div",Q,[s("div",W,[l(I,{to:`/product/${t.product.id}`,class:"text-decoration-none text-cusDarkBrown",onClick:F(()=>o.getProduct(t.product.id),["prevent"])},{default:k(()=>[T(n(t.product.title),1)]),_:2},1032,["to","onClick"])]),s("div",X," NT$ "+n(t.product.price)+" / "+n(t.product.unit),1)])]),s("td",Y,"x "+n(t.qty),1),s("td",Z,[o.cart.final_total!==o.cart.total?(d(),c("div",ss,[es,ts,T(" NT$ "+n(o.$filters.currency(t.final_total)),1)])):(d(),c("div",os,"NT$ "+n(t.total),1))])]))),128))])])):A("",!0),s("div",as,[s("div",ls,[x(s("input",{type:"text",class:"form-control",placeholder:"請輸入優惠券代碼","aria-label":"Recipient's coupon","aria-describedby":"couponInput","onUpdate:modelValue":e[0]||(e[0]=t=>a.coupon_code=t)},null,512),[[V,a.coupon_code]]),s("button",{class:"btn btn-outline-primary",type:"button",id:"couponInput",onClick:e[1]||(e[1]=F(()=>f.addCouponCode(),["prevent"]))}," 套用優惠券碼 ")]),rs,s("div",ns," NT$ "+n(o.cart.total),1),is,s("div",ds," -NT$ "+n(o.cart.final_total-o.cart.total),1),cs,s("div",us," NT$ "+n(o.cart.final_total),1)])])])]),s("div",ms,[ps,l(S,{onSubmit:f.createOrder},{default:k(({errors:t})=>[s("div",_s,[hs,l(p,{type:"email",name:"email",class:h(["form-control",{"is-invalid":t.email}]),id:"email",rules:"email|required","aria-describedby":"emailHelp",placeholder:"請輸入 Email",modelValue:a.userForm.user.email,"onUpdate:modelValue":e[2]||(e[2]=r=>a.userForm.user.email=r)},null,8,["class","modelValue"]),l(_,{name:"email",class:"invalid-feedback"})]),s("div",bs,[fs,l(p,{type:"text",name:"姓名",class:h(["form-control",{"is-invalid":t.姓名}]),rules:"required",id:"InputUserName",placeholder:"請輸入姓名",modelValue:a.userForm.user.name,"onUpdate:modelValue":e[3]||(e[3]=r=>a.userForm.user.name=r)},null,8,["class","modelValue"]),l(_,{name:"姓名",class:"invalid-feedback"})]),s("div",vs,[ws,l(p,{type:"tel",name:"電話",class:h(["form-control",{"is-invalid":t.電話}]),rules:"required|min:8|max:10",id:"InputUserTel",placeholder:"請輸入電話",modelValue:a.userForm.user.tel,"onUpdate:modelValue":e[4]||(e[4]=r=>a.userForm.user.tel=r)},null,8,["class","modelValue"]),l(_,{name:"電話",class:"invalid-feedback"})]),s("div",gs,[ys,l(p,{type:"text",name:"地址",class:h([{"is-invalid":t.地址},"form-control"]),rules:"required",id:"InputUserAddress",placeholder:"請輸入地址",modelValue:a.userForm.user.address,"onUpdate:modelValue":e[5]||(e[5]=r=>a.userForm.user.address=r)},null,8,["class","modelValue"]),l(_,{name:"地址",class:"invalid-feedback"})]),s("div",xs,[Vs,x(s("textarea",{class:"form-control",id:"FormControlTextarea",placeholder:"歡迎留下想對我們說的話!",rows:"3","onUpdate:modelValue":e[6]||(e[6]=r=>a.userForm.message=r)},null,512),[[V,a.userForm.message]])]),Fs]),_:1},8,["onSubmit"])])])])]),l(E,{active:o.isLoading,"onUpdate:active":e[7]||(e[7]=t=>o.isLoading=t),loader:"dots"},null,8,["active"])],64)}const Is=N(D,[["render",ks]]);export{Is as default};
