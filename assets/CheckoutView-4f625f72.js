import{_ as w,a as n,r as a,o as d,c as i,b as t,F as c,e as g,t as e,n as v,g as y,d as u,w as x,f}from"./index-bbf47dbb.js";import{s as L}from"./swalMessage-cdcc8a09.js";import{c as k}from"./cartStore-ce1406cb.js";const{VITE_APP_URL:_,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/V2",VITE_APP_PATH:"tttom3669",BASE_URL:"/vue3_pizza/",MODE:"production",DEV:!1,PROD:!0},V={data(){return{order:{user:{},products:[]},isLoading:!1}},props:["orderId"],methods:{...n(L,["swalShow"]),...n(k,["getCart"]),getOrder(){const l=`${_}/api/${h}/order/${this.orderId}`;this.isLoading=!0,this.$http.get(l).then(o=>{this.isLoading=!1,this.order=o.data.order,this.getCart()}).catch(o=>{this.isLoading=!1,this.swalShow(`${o.response.data.message}`,"error")})},payOrder(){const l=`${_}/api/${h}/pay/${this.orderId}`;this.isLoading=!0,this.$http.post(l).then(o=>{this.getOrder(),this.getCart(),this.swalShow(`${o.data.message}`,"success","toast")}).catch(o=>{this.swalShow(`${o.response.data.message}`,"error"),this.isLoading=!1})}},mounted(){this.getOrder(),this.swalShow("已建立訂單","success","toast")}},P={class:"bg_texture3",style:{"min-height":"600px"}},T={class:"container"},C=t("div",{class:"row d-flex justify-content-center mt-3"},[t("div",{class:"col-12 col-md-6"},[t("div",{class:"col"},[t("div",{class:"position-relative m-4"},[t("div",{class:"progress",style:{height:"1px"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"50%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),t("div",{class:"position-absolute top-0 start-0 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 1 "),t("div",{class:"position-absolute top-0 start-50 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 2 "),t("div",{class:"position-absolute top-0 start-100 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 3 ")])]),t("div",{class:"col d-flex justify-content-between text-primary fw-bold"},[t("span",{class:"ms-n1"},"確認購買"),t("span",null,"填寫資料"),t("span",{class:"me-n1"},"完成訂單")])])],-1),E={class:"row mt-4 d-flex flex-column flex-lg-row"},A={class:"col-lg-5"},D={class:"card"},S={class:"card-body"},I=t("h5",{class:"card-title"},"訂單明細",-1),N={class:"table align-middle"},O=["src"],B={class:"p-2"},j={class:"text-nowrap"},U={class:"text-nowrap"},F={class:"text-nowrap text-end"},M={class:"row row-cols-2 d-flex justify-content-between"},R=t("div",{class:"pb-2 col text-cusGray fw-bold text-start"}," 運費 ",-1),z={class:"pb-2 col text-cusGray fw-bold text-end"},G=t("div",{class:"col py-2 h5 text-cusDarkBrown fw-bold text-start"}," 總金額 ",-1),H={class:"col py-2 h5 text-cusDarkBrown fw-bold text-end"},q={class:"col-lg-7"},J={class:"card mt-3 mt-md-0"},K={class:"card-body"},Q=t("h5",{class:"card-title"},"訂單資訊",-1),W={key:0,class:"table"},X=t("td",null,"訂單編號",-1),Y=t("td",null,"下單時間",-1),Z=t("td",null,"Email",-1),$=t("td",null,"收件人姓名",-1),tt=t("td",null,"收件人電話",-1),st=t("td",null,"收件人地址",-1),et=t("td",null,"取貨方式",-1),ot=t("td",null,"付款方式",-1),rt=t("td",null,"付款狀態",-1),lt=t("td",null,"備註",-1),dt={class:"d-flex justify-content-end mt-3 mb-3"},it={key:1,type:"button",class:"btn btn-primary text-white"};function nt(l,o,at,ct,s,p){const m=a("router-link"),b=a("VueLoading");return d(),i(c,null,[t("div",P,[t("div",T,[C,t("div",E,[t("div",A,[t("div",D,[t("div",S,[I,t("table",N,[t("tbody",null,[(d(!0),i(c,null,g(s.order.products,r=>(d(),i("tr",{key:r.id},[t("td",null,[t("img",{src:r.product.imageUrl,alt:"",class:"object-fit-cover",height:"70",width:"70"},null,8,O)]),t("td",B,[t("div",j,e(r.product.title),1)]),t("td",U,"x "+e(r.qty),1),t("td",F," NT$ "+e(l.$filters.currency(r.final_total)),1)]))),128))])]),t("div",M,[R,t("div",z," +NT$ "+e(s.order.user.cartDeliveryFee),1),G,t("div",H," NT$ "+e(s.order.total+s.order.user.cartDeliveryFee),1)])])])]),t("div",q,[t("div",J,[t("div",K,[Q,s.order?(d(),i("table",W,[t("tbody",null,[t("tr",null,[X,t("td",null,e(s.order.id),1)]),t("tr",null,[Y,t("td",null,e(l.$filters.date(s.order.create_at)),1)]),t("tr",null,[Z,t("td",null,e(s.order.user.email),1)]),t("tr",null,[$,t("td",null,e(s.order.user.name),1)]),t("tr",null,[tt,t("td",null,e(s.order.user.address),1)]),t("tr",null,[st,t("td",null,e(s.order.user.tel),1)]),t("tr",null,[et,t("td",null,e(s.order.user.pickupMethod),1)]),t("tr",null,[ot,t("td",null,e(s.order.user.paymentMethod),1)]),t("tr",null,[rt,t("td",{class:v(["fw-bold",{"text-success":s.order.is_paid,"text-danger":!s.order.is_paid}])},e(s.order.is_paid?"付款完成":"尚未付款"),3)]),t("tr",null,[lt,t("td",null,e(s.order.message),1)])])])):y("",!0)])]),t("div",dt,[s.order.is_paid?(d(),i("button",it,[u(m,{to:"/",class:"text-decoration-none text-white"},{default:x(()=>[f(" 返回首頁 ")]),_:1})])):(d(),i("button",{key:0,type:"button",class:"btn btn-primary text-white",onClick:o[0]||(o[0]=()=>p.payOrder())}," 來去付款 "))])])])])]),u(b,{active:s.isLoading,"onUpdate:active":o[1]||(o[1]=r=>s.isLoading=r),loader:"dots"},null,8,["active"])],64)}const pt=w(V,[["render",nt]]);export{pt as default};
