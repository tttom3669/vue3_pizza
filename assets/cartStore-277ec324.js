import{p as c,a as n,q as o}from"./index-05d0b8dc.js";import{s as h}from"./swalMessage-2a95176c.js";const l=c("loadingStore",{state:()=>({isLoading:!1,loadingItem:""})}),{VITE_APP_URL:i,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/V2",VITE_APP_PATH:"tttom3669",BASE_URL:"/vue3_pizza/",MODE:"production",DEV:!1,PROD:!0},a=l(),p=c("cart",{state:()=>({cart:{}}),actions:{...n(h,["swalShow"]),getCart(){a.isLoading=!0,o.get(`${i}/api/${r}/cart`).then(t=>{this.cart=t.data.data,this.cart.carts.forEach(s=>{s.qty>20&&this.fixCartItem(s)}),a.isLoading=!1}).catch(t=>{this.swalShow(`${t.response.data.message}`,"error"),a.isLoading=!1})},addToCart(t,s=1){a.loadingItem=t;const d={product_id:t,qty:s};o.post(`${i}/api/${r}/cart`,{data:d}).then(e=>{this.swalShow(`${e.data.message}`,"success","toast"),a.loadingItem="",this.getCart()}).catch(e=>{this.swalShow(`${e.response.data.message}`,"error"),a.loadingItem=""})},updateCartItem(t,s){const d={product_id:t.product.id,qty:s};a.loadingItem=t.id,o.put(`${i}/api/${r}/cart/${t.id}`,{data:d}).then(e=>{this.swalShow(`${e.data.message}`,"success","toast"),this.getCart(),a.loadingItem=""}).catch(e=>{this.swalShow(`${e.response.data.message}`,"error"),a.loadingItem=""})},fixCartItem(t){const s={product_id:t.product_id,qty:20};a.loadingItem=t.id,o.put(`${i}/api/${r}/cart/${t.id}`,{data:s}).then(()=>{this.swalShow("商品超出庫存，已自動修正數量","warning","toast"),this.getCart(),a.loadingItem=""}).catch(d=>{this.swalShow(`${d.response.data.message}`,"error"),a.loadingItem=""})},deleteCartItem(t){a.loadingItem=t.id,o.delete(`${i}/api/${r}/cart/${t.id}`).then(s=>{this.swalShow(`購物車${s.data.message}`,"success","toast"),this.getCart(),a.loadingItem=""}).catch(s=>{this.swalShow(`${s.response.data.message}`,"error"),a.loadingItem=""})},deleteCart(){a.loadingItem="deleteCart",o.delete(`${i}/api/${r}/carts`).then(()=>{this.swalShow("已清空購物車","success","toast"),this.getCart(),a.loadingItem=""}).catch(t=>{this.swalShow(`${t.response.data.message}`,"error"),a.loadingItem=""})}}});export{p as c,l};
