import{_ as b,m as n,r as a,o as i,c as d,a as t,F as c,f as g,t as o,n as f,h as v,b as h,w as y,d as x}from"./index-c6ed4168.js";import{s as L}from"./swalMessage-905c8f09.js";import{c as V}from"./cartStore-581dafbd.js";import"./sweetalert2.all-526cafe2.js";const{VITE_APP_URL:u,VITE_APP_PATH:_}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/V2",VITE_APP_PATH:"tttom3669",BASE_URL:"/vue3_pizza/",MODE:"production",DEV:!1,PROD:!0},k={data(){return{order:{user:{},products:[]},isLoading:!1}},props:["orderId"],methods:{...n(L,["swalShow"]),...n(V,["getCart"]),getOrder(){const l=`${u}/api/${_}/order/${this.orderId}`;this.isLoading=!0,this.$http.get(l).then(e=>{this.isLoading=!1,this.order=e.data.order,this.getCart()}).catch(e=>{this.isLoading=!1,this.swalShow(`${e.response.data.message}`,"error")})},payOrder(){const l=`${u}/api/${_}/pay/${this.orderId}`;this.isLoading=!0,this.$http.post(l).then(e=>{this.getOrder(),this.getCart(),this.swalShow(`${e.data.message}`,"success","toast")}).catch(e=>{this.swalShow(`${e.response.data.message}`,"error"),this.isLoading=!1})}},mounted(){this.getOrder(),this.swalShow("已建立訂單","success","toast")}},P={class:"container"},C=t("div",{class:"row d-flex justify-content-center mt-3"},[t("div",{class:"col-12 col-md-6"},[t("div",{class:"col"},[t("div",{class:"position-relative m-4"},[t("div",{class:"progress",style:{height:"1px"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"50%"},"aria-valuenow":"50","aria-valuemin":"0","aria-valuemax":"100"})]),t("div",{class:"position-absolute top-0 start-0 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 1 "),t("div",{class:"position-absolute top-0 start-50 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 2 "),t("div",{class:"position-absolute top-0 start-100 text-white translate-middle btn btn-sm btn-primary rounded-pill",style:{width:"2rem",height:"2rem"}}," 3 ")])]),t("div",{class:"col d-flex justify-content-between text-primary fw-bold"},[t("span",{class:"ms-n1"},"確認購買"),t("span",null,"填寫資料"),t("span",{class:"me-n1"},"完成訂單")])])],-1),E={class:"row mt-4 d-flex flex-column flex-lg-row"},T={class:"col-lg-5"},A={class:"card"},S={class:"card-body"},I=t("h5",{class:"card-title"},"訂單明細",-1),O={class:"table align-middle"},B=["src"],D={class:"p-2"},N={class:"text-nowrap"},j={class:"text-nowrap"},U={class:"text-nowrap text-end"},R={class:"row row-cols-2 d-flex justify-content-between"},z=t("div",{class:"col py-2 h5 text-cusDarkBrown fw-bold text-start"}," 總金額 ",-1),F={class:"col py-2 h5 text-cusDarkBrown fw-bold text-end"},H={class:"col-lg-7"},M={class:"card mt-3 mt-md-0"},$={class:"card-body"},q=t("h5",{class:"card-title"},"訂單資訊",-1),G={key:0,class:"table"},J=t("td",null,"訂單編號",-1),K=t("td",null,"下單時間",-1),Q=t("td",null,"Email",-1),W=t("td",null,"收件人姓名",-1),X=t("td",null,"收件人電話",-1),Y=t("td",null,"收件人地址",-1),Z=t("td",null,"付款狀態",-1),tt=t("td",null,"備註",-1),st={class:"d-flex justify-content-end mt-3 mb-3"},et={key:1,type:"button",class:"btn btn-primary text-white"};function ot(l,e,rt,lt,s,p){const m=a("router-link"),w=a("VueLoading");return i(),d(c,null,[t("div",P,[C,t("div",E,[t("div",T,[t("div",A,[t("div",S,[I,t("table",O,[t("tbody",null,[(i(!0),d(c,null,g(s.order.products,r=>(i(),d("tr",{key:r.id},[t("td",null,[t("img",{src:r.product.imageUrl,alt:"",class:"object-fit-cover",height:"70",width:"70"},null,8,B)]),t("td",D,[t("div",N,o(r.product.title),1)]),t("td",j,"x "+o(r.qty),1),t("td",U," NT$ "+o(l.$filters.currency(r.final_total)),1)]))),128))])]),t("div",R,[z,t("div",F," NT$ "+o(s.order.total),1)])])])]),t("div",H,[t("div",M,[t("div",$,[q,s.order?(i(),d("table",G,[t("tbody",null,[t("tr",null,[J,t("td",null,o(s.order.id),1)]),t("tr",null,[K,t("td",null,o(l.$filters.date(s.order.create_at)),1)]),t("tr",null,[Q,t("td",null,o(s.order.user.email),1)]),t("tr",null,[W,t("td",null,o(s.order.user.name),1)]),t("tr",null,[X,t("td",null,o(s.order.user.address),1)]),t("tr",null,[Y,t("td",null,o(s.order.user.tel),1)]),t("tr",null,[Z,t("td",{class:f(["fw-bold",{"text-success":s.order.is_paid,"text-danger":!s.order.is_paid}])},o(s.order.is_paid?"付款完成":"尚未付款"),3)]),t("tr",null,[tt,t("td",null,o(s.order.message),1)])])])):v("",!0)])]),t("div",st,[s.order.is_paid?(i(),d("button",et,[h(m,{to:"/",class:"text-decoration-none text-white"},{default:y(()=>[x(" 返回首頁 ")]),_:1})])):(i(),d("button",{key:0,type:"button",class:"btn btn-primary text-white",onClick:e[0]||(e[0]=()=>p.payOrder())}," 來去付款 "))])])])]),h(w,{active:s.isLoading,"onUpdate:active":e[1]||(e[1]=r=>s.isLoading=r),loader:"dots"},null,8,["active"])],64)}const ct=b(k,[["render",ot]]);export{ct as default};
